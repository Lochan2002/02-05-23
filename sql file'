CREATE TABLE CAR(
CAR_NO INT NOT NULL,CAR_NAME VARCHAR(20) NOT NULL, CAR_PRICE INT NOT NULL,CAR_QUANTITY INT NOT NULL);
INSERT INTO CAR VALUES(101,"TESLA",1200000,2),(102,"BMW",2500000,1),(103,"AUDI",2500000,2),(104,"TATA NANO",800000,3),(105,"KIA",800000,2);
SELECT * FROM CAR;
SELECT COUNT(CAR_NAME),CAR_PRICE FROM CAR GROUP BY CAR_PRICE;
SELECT COUNT(*) AS COUNT_NUMBER,CAR_PRICE FROM CAR GROUP BY CAR_PRICE; 
SELECT MAX(CAR_PRICE) FROM CAR GROUP BY CAR_PRICE HAVING CAR_PRICE>1200000;

CREATE TABLE VISIT(
ENTRY_DATE DATE,ENTRY_PRICE INT,DURATION INT);
INSERT INTO VISIT VALUES('2023-05-01',1000,35),('2023-05-02',750,50),('2023-05-01',500,60);
SELECT * FROM VISIT;
INSERT INTO VISIT VALUES('2023-05-03',650,45),('2023-05-01',850,30);
SELECT COUNT(*),DURATION FROM VISIT GROUP BY DURATION;

SELECT EXTRACT(YEAR FROM ENTRY_DATE) AS YEAR,
EXTRACT(MONTH FROM ENTRY_DATE) AS MONTH, ROUND(AVG(ENTRY_PRICE),2) -- USED TO ROUND UP TO 2 DECIMALS
FROM VISIT GROUP BY EXTRACT(YEAR FROM ENTRY_DATE),EXTRACT(MONTH FROM ENTRY_DATE);

SELECT EXTRACT(YEAR FROM ENTRY_DATE) AS YEAR,
EXTRACT(MONTH FROM ENTRY_DATE) AS MONTH,EXTRACT(DAY FROM ENTRY_DATE) AS DAY1, ROUND(AVG(ENTRY_PRICE),2) -- USED TO ROUND UP TO 2 DECIMALS
FROM VISIT GROUP BY EXTRACT(YEAR FROM ENTRY_DATE),EXTRACT(MONTH FROM ENTRY_DATE),EXTRACT(DAY FROM ENTRY_DATE)
ORDER BY EXTRACT(YEAR FROM ENTRY_DATE),EXTRACT(MONTH FROM ENTRY_DATE);

SELECT ENTRY_DATE,ROUND(AVG(ENTRY_PRICE),2) AS AVG_PRICE FROM VISIT GROUP BY ENTRY_DATE HAVING COUNT(*)>=3 ORDER BY ENTRY_DATE;
SELECT ENTRY_DATE,ROUND(AVG(ENTRY_PRICE),2) AS AVG_PRICE FROM VISIT WHERE DURATION>30
GROUP BY ENTRY_DATE HAVING COUNT(*)>1 ORDER BY ENTRY_DATE;

SELECT * FROM customer; 
